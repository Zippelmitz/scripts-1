#!/usr/bin/env perl

use strict;
use warnings;

my $total = 0;

my $prove_fh;
if (-t \*STDIN) {
  ## Open and list form: only works on fork()-able OS's, so no Windows for you...
  open($prove_fh, '-|', 'prove', '-v', @ARGV);
}
else {
  $prove_fh = \*STDIN;
}

$|++;
while (<$prove_fh>) {
  print;
  $total += $1 if m/^\s*1[.][.](\d+)\s*$/;
}

END { print "*** Total tests seen: $total\n" }
